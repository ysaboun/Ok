Parfait, on enl√®ve toute b√©quille externe.
Voici un **exemple hCaptcha en Node.js natif**, sans `axios`, sans framework lourd c√¥t√© HTTP client. Juste **Node, `https` et du bon sens**.

---

## 1Ô∏è‚É£ Rappel c√¥t√© HTML (inchang√©)

```html
<script src="https://js.hcaptcha.com/1/api.js" async defer></script>

<form method="POST" action="/verify-captcha">
  <div class="h-captcha" data-sitekey="YOUR_HCAPTCHA_SITE_KEY"></div>
  <button type="submit">Valider</button>
</form>
```

Le navigateur envoie automatiquement :

```text
h-captcha-response=<token>
```

---

## 2Ô∏è‚É£ Node.js natif ‚Äî v√©rification hCaptcha (sans axios)

### Serveur HTTP simple

```js
const http = require("http");
const https = require("https");
const querystring = require("querystring");

const HCAPTCHA_SECRET = "YOUR_HCAPTCHA_SECRET_KEY";

const server = http.createServer((req, res) => {
  if (req.method === "POST" && req.url === "/verify-captcha") {
    let body = "";

    req.on("data", chunk => {
      body += chunk.toString();
    });

    req.on("end", () => {
      const parsedBody = querystring.parse(body);
      const hcaptchaToken = parsedBody["h-captcha-response"];

      if (!hcaptchaToken) {
        res.writeHead(400);
        return res.end("Token hCaptcha manquant");
      }

      verifyHcaptcha(hcaptchaToken, (err, result) => {
        if (err) {
          res.writeHead(500);
          return res.end("Erreur validation hCaptcha");
        }

        if (!result.success) {
          res.writeHead(403);
          return res.end("√âchec hCaptcha");
        }

        // üëâ Logique Robot Detection
        const scoreId = `RD-${Date.now()}`;

        res.writeHead(200, { "Content-Type": "application/json" });
        res.end(JSON.stringify({
          message: "hCaptcha valid√©",
          scoreId: scoreId,
          hcaptchaScore: result.score
        }));
      });
    });
  } else {
    res.writeHead(404);
    res.end();
  }
});

server.listen(3000, () => {
  console.log("Server running on port 3000");
});
```

---

## 3Ô∏è‚É£ Appel API hCaptcha en Node natif (`https`)

```js
function verifyHcaptcha(token, callback) {
  const postData = querystring.stringify({
    secret: HCAPTCHA_SECRET,
    response: token
  });

  const options = {
    hostname: "hcaptcha.com",
    path: "/siteverify",
    method: "POST",
    headers: {
      "Content-Type": "application/x-www-form-urlencoded",
      "Content-Length": Buffer.byteLength(postData)
    }
  };

  const req = https.request(options, res => {
    let data = "";

    res.on("data", chunk => {
      data += chunk;
    });

    res.on("end", () => {
      try {
        const parsed = JSON.parse(data);
        callback(null, parsed);
      } catch (e) {
        callback(e);
      }
    });
  });

  req.on("error", err => {
    callback(err);
  });

  req.write(postData);
  req.end();
}
```

---

## 4Ô∏è‚É£ Lecture architecture (tr√®s importante pour ton slide)

* Node.js **ne fait que v√©rifier** le token aupr√®s de hCaptcha
* Le r√©sultat hCaptcha :

  * `success`
  * `score`
* Robot Detection :

  * transforme ce r√©sultat en **score interne**
  * applique ses r√®gles de d√©cision
* Aucune d√©pendance externe ‚Üí facile √† auditer, facile √† durcir

---

## 5Ô∏è‚É£ Phrase parfaite pour slide technique

> *hCaptcha fournit un signal, Robot Detection prend la d√©cision.*

Si tu veux, je peux te donner :

* une version **asynchrone `async/await` toujours native**
* une version **API-only sans formulaire**
* ou une version **mutualis√©e pr√™te pour un socle groupe (timeout, retry, circuit breaker minimal)**
